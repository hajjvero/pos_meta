{# templates/admin/customer/orders_tab.html.twig #}
<div class="customer-orders-section">
    <div class="card">
        <div class="card-header">
            <h5 class="card-title mb-0">
                <i class="fas fa-shopping-cart me-2"></i>
                {{ 'Orders'|trans }}
{#                <span class="badge bg-primary ms-2">{{ entity.orders|length }}</span>#}
            </h5>
        </div>

        {#{% if entity.orders|length > 0 %}
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-striped table-hover mb-0">
                        <thead class="table-dark">
                            <tr>
                                <th>{{ 'Order Code'|trans }}</th>
                                <th>{{ 'Date'|trans }}</th>
                                <th>{{ 'Total Amount'|trans }}</th>
                                <th>{{ 'Cashier'|trans }}</th>
                                <th>{{ 'Items Count'|trans }}</th>
                                <th>{{ 'Actions'|trans }}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for order in entity.orders|sort((a, b) => b.date <=> a.date) %}
                                <tr>
                                    <td>
                                        <strong class="text-primary">{{ order.code }}</strong>
                                    </td>
                                    <td>
                                        <span class="text-muted">
                                            {{ order.date|date('d/m/Y H:i') }}
                                        </span>
                                    </td>
                                    <td>
                                        <span class="badge bg-success">
                                            {{ order.totalAmount|number_format(2, '.', ',') }} €
                                        </span>
                                    </td>
                                    <td>
                                        {{ order.cashier ? order.cashier.name : 'N/A' }}
                                    </td>
                                    <td>
                                        <span class="badge bg-info">
                                            {{ order.orderItems|length }}
                                        </span>
                                    </td>
                                    <td>
                                        <div class="btn-group btn-group-sm" role="group">
                                            <a href="{{ ea_url({ crudAction: 'detail', crudControllerFqcn: 'App\\Controller\\Admin\\Order\\OrderCrudController', entityId: order.id }) }}"
                                               class="btn btn-outline-primary btn-sm"
                                               title="{{ 'View Order Details'|trans }}">
                                                <i class="fas fa-eye"></i>
                                            </a>
                                            <a href="{{ ea_url({ crudAction: 'edit', crudControllerFqcn: 'App\\Controller\\Admin\\Order\\OrderCrudController', entityId: order.id }) }}"
                                               class="btn btn-outline-secondary btn-sm"
                                               title="{{ 'Edit Order'|trans }}">
                                                <i class="fas fa-edit"></i>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card-footer bg-light">
                <div class="row">
                    <div class="col-md-6">
                        <small class="text-muted">
                            <i class="fas fa-info-circle me-1"></i>
                            {{ 'Total Orders'|trans }}: <strong>{{ entity.orders|length }}</strong>
                        </small>
                    </div>
                    <div class="col-md-6 text-end">
                        <small class="text-muted">
                            {% set totalRevenue = 0 %}
                            {% for order in entity.orders %}
                                {% set totalRevenue = totalRevenue + order.totalAmount %}
                            {% endfor %}
                            <i class="fas fa-euro-sign me-1"></i>
                            {{ 'Total Revenue'|trans }}: <strong>{{ totalRevenue|number_format(2, '.', ',') }} €</strong>
                        </small>
                    </div>
                </div>
            </div>
        {% else %}
            <div class="card-body text-center py-5">
                <div class="text-muted">
                    <i class="fas fa-shopping-cart fa-3x mb-3 opacity-25"></i>
                    <h6>{{ 'No orders found'|trans }}</h6>
                    <p class="mb-0">{{ 'This customer hasn\'t placed any orders yet.'|trans }}</p>
                </div>
            </div>
        {% endif %}#}
    </div>
</div>

<style>
.customer-orders-section {
    margin-top: 1rem;
}

.customer-orders-section .table th {
    font-weight: 600;
    font-size: 0.875rem;
    border-top: none;
}

.customer-orders-section .table td {
    vertical-align: middle;
}

.customer-orders-section .btn-group-sm .btn {
    padding: 0.25rem 0.5rem;
}

.customer-orders-section .badge {
    font-size: 0.75rem;
}

@media (max-width: 768px) {
    .customer-orders-section .table-responsive {
        font-size: 0.875rem;
    }

    .customer-orders-section .btn-group-sm .btn {
        padding: 0.125rem 0.25rem;
    }
}
</style>
